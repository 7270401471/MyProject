/*
 * File: app/view/role/RoleFuncWinViewController.js
 *
 * This file was generated by Sencha Architect version 3.1.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 5.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 5.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('Evcorp.view.user.UserRoleWinViewController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.useruserrolewin',
    onAddRoleClick: function (btn){
    	var roleOuGrid = btn.up('window').down('grid');
    	var addRoleWin = Ext.create('Evcorp.view.user.AddRoleWin',{
    		userId : roleOuGrid.userId
    		}
    	);
    	addRoleWin.down('#ouCombo').getStore().removeAll();
    	addRoleWin.show();
    },
    onDeleteRoleClick: function(btn){
    	Ext.Msg.alert("提示",'删除成功。');
    	var grid = btn.up('window').down('grid');
    	var userId = grid.userId;
        var records = grid.getSelectionModel().getSelection();
        var ids = [];
        Ext.each(records,function(obj,index){
        	ids.push(obj.id);
        });
        var param = {ids : ids};
        auUserContro.deleteUserRole(param,function(result){
        	if(result == 'success'){
        		grid.getStore().reload({
        			params:{id : userId}
        		});
        	}else{
        		Ext.Msg.alert("提示",'删除失败。');
        	}
        	
        });
    },
    onCloseClick: function(btn){
    	this.getView().close();
    }
});
